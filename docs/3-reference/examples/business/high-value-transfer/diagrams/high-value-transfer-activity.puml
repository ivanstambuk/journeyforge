@startuml
!include journey-diagram-theme.puml
title high-value-transfer â€“ client activity flow

start

:Client sends\nPOST /api/v1/journeys/high-value-transfer/start\nwith HighValueTransferStartRequest;

repeat
  :Client calls\nGET /api/v1/journeys/{journeyId}/result;
  :Journeys API returns\nJourneyOutcome with phase/output;
repeat while (phase == "Running" and\ncurrentState != "waitForApproval") is (checks running)

if (currentState == "waitForApproval"?) then (yes)
  :Operator submits approval/rejection\nPOST /api/v1/journeys/{journeyId}/steps/approveTransfer;
  :Client resumes polling\nGET /api/v1/journeys/{journeyId}/result;
  :Journeys API returns\nJourneyOutcome once settlement completes;
endif

if (phase == "Succeeded" and decision == "SETTLED"?) then (settled)
  :Client confirms settlement and updates\nlocal ledgers or UI;
  stop
else (failed/rejected)
  :Client handles FAILED or REJECTED\nbased on failureReason/rejectionReason;
  stop
endif

@enduml

