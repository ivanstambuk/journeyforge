@startuml
!include journey-diagram-theme.puml
title customer-onboarding-kyc â€“ client activity flow

start

:Client sends\nPOST /api/v1/journeys/customer-onboarding-kyc/start\nwith CustomerOnboardingKycStartRequest;
:Journeys API returns\nJourneyStatus at waitForKycDocuments\n(phase = Running);

:Customer uploads documents and details\nPOST /api/v1/journeys/{journeyId}/steps/submitKycDocuments;

if (currentState == "waitForKycResult"?) then (yes)
  :KYC provider posts result\nPOST /api/v1/journeys/{journeyId}/steps/waitForKycResult;
endif

if (currentState == "waitForAmlResult"?) then (yes)
  :AML provider posts result\nPOST /api/v1/journeys/{journeyId}/steps/waitForAmlResult;
endif

if (currentState == "waitForRiskDecision"?) then (yes)
  :Risk/compliance system posts decision\nPOST /api/v1/journeys/{journeyId}/steps/waitForRiskDecision;
endif

:Client calls\nGET /api/v1/journeys/{journeyId}/result;
:Journeys API returns\nJourneyOutcome with finalStatus\n(APPROVED or REJECTED);

if (phase == "SUCCEEDED" and finalStatus == "APPROVED"?) then (approved)
  :Client treats customer as fully onboarded\nand proceeds with account usage;
  stop
else (rejected)
  :Client handles REJECTED onboarding based on\nrejectionReason and check results;
  stop
endif

@enduml
