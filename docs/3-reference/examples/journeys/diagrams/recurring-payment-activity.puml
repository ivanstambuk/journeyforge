@startuml
!include journey-diagram-theme.puml
title recurring-payment â€“ client activity flow

start

:Client sends\nPOST /api/v1/journeys/recurring-payment/start\nwith RecurringPaymentStartRequest\n(userId, paymentMethodRef,\namount, currency, interval, maxRuns);

:Journeys API creates or updates\nschedule binding via task.kind: schedule\nand returns JourneyOutcome with\noutput.status == \"SCHEDULED\" and\nconfigured schedule fields;

if (JourneyOutcome.phase == "SUCCEEDED"?) then (yes)
  :Client records schedule configuration\nfor the user;
  stop
else (failed)
  :Client handles configuration failure\nbased on error.code / error.reason;
  stop
endif

@enduml
