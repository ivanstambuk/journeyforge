@startuml
!include journey-diagram-theme.puml
title recurring-payment â€“ configure and scheduled run sequence

actor "Client" as Client
participant "Journeys API" as Journeys
participant "Payments API" as Payments

Client -> Journeys: POST /api/v1/journeys/recurring-payment/start\nRecurringPaymentStartRequest
Journeys -> Journeys: Configure schedule and complete initial run
Journeys --> Client: 200 OK\nJourneyOutcome (status = SCHEDULED, config fields)

... later, on schedule ...

Journeys -> Payments: POST /payments/{paymentMethodRef}/authorize\n(amount, currency)
Payments --> Journeys: 202 Accepted\n(authorization accepted)

Journeys -> Journeys: update context.lastRunAt / lastStatus / lastOk\nfor the scheduled run

@enduml
