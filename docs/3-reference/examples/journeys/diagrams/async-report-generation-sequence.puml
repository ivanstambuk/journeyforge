@startuml
!include journey-diagram-theme.puml
title async-report-generation â€“ sequence

actor "Client" as Client
participant "Journeys API" as Journeys
participant "Reports API" as Reports

Client -> Journeys: POST /api/v1/journeys/async-report-generation/start\nAsyncReportGenerationStartRequest
Journeys -> Reports: POST https://reports.example.com/jobs\n(report parameters)
Reports --> Journeys: 202 Accepted\n(jobId)
Journeys --> Client: 202 Accepted\nJourneyStartResponse\n(journeyId, statusUrl)

== Report job running ==

loop While phase == "RUNNING"
  Client -> Journeys: GET /journeys/{journeyId}\n(getStatusRunning)
  Journeys --> Client: 200 OK\nJourneyStatus (phase = Running)
end

Client -> Journeys: GET /journeys/{journeyId}/result\n(getResult)
Journeys --> Client: 200 OK\nJourneyOutcome (status = REPORT_COMPLETED\nor REPORT_FAILED)

@enduml
